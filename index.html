<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–∞–π—Ç</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .btn-primary {
            background: #3498db;
            color: white;
        }
        .btn-success {
            background: #2ecc71;
            color: white;
        }
        .btn-warning {
            background: #f39c12;
            color: white;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .iframe-container {
            position: relative;
            width: 100%;
            height: 80vh;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .loading {
            display: none;
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #7f8c8d;
        }
        .error {
            display: none;
            text-align: center;
            padding: 50px;
            color: #e74c3c;
            background: #fdf2f2;
            margin: 20px;
            border-radius: 10px;
        }
        .status-bar {
            background: #ecf0f1;
            padding: 10px 20px;
            font-size: 14px;
            color: #7f8c8d;
            border-top: 1px solid #bdc3c7;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåê –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–∞–π—Ç–∞</h1>
            <div class="controls">
                <button class="btn-primary" onclick="loadWithProxy()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —á–µ—Ä–µ–∑ Proxy</button>
                <button class="btn-success" onclick="loadWithHeaders()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏</button>
                <button class="btn-warning" onclick="openDirect()">–û—Ç–∫—Ä—ã—Ç—å –Ω–∞–ø—Ä—è–º—É—é</button>
                <button onclick="refresh()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>

        <div class="loading" id="loading">
            <div>‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∞–π—Ç–∞... –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ</div>
        </div>

        <div class="error" id="error">
            <h3>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
            <p id="errorMessage">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ</p>
            <button class="btn-primary" onclick="retry()">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É</button>
        </div>

        <div class="iframe-container">
            <iframe 
                id="embeddedFrame"
                src=""
                sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-modals"
                allow="fullscreen *"
                referrerpolicy="no-referrer"
                onload="hideLoading()"
                onerror="showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ iframe')">
            </iframe>
        </div>

        <div class="status-bar">
            <span id="status">–ì–æ—Ç–æ–≤ –∫ –∑–∞–≥—Ä—É–∑–∫–µ. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏.</span>
            <span id="currentMethod" style="float: right;"></span>
        </div>
    </div>

    <script>
        const frame = document.getElementById('embeddedFrame');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const status = document.getElementById('status');
        const currentMethod = document.getElementById('currentMethod');
        const errorMessage = document.getElementById('errorMessage');

        const targetUrl = 'http://f1176452.xsph.ru/';

        // –°–ø–∏—Å–æ–∫ CORS –ø—Ä–æ–∫—Å–∏
        const proxies = [
            'https://cors-anywhere.herokuapp.com/',
            'https://api.codetabs.com/v1/proxy?quest=',
            'https://corsproxy.io/?',
            'https://proxy.cors.sh/'
        ];

        function showLoading() {
            loading.style.display = 'block';
            error.style.display = 'none';
        }

        function hideLoading() {
            loading.style.display = 'none';
            error.style.display = 'none';
            status.textContent = '–°–∞–π—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω';
        }

        function showError(message) {
            loading.style.display = 'none';
            error.style.display = 'block';
            errorMessage.textContent = message;
            status.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
        }

        function updateStatus(text, method = '') {
            status.textContent = text;
            currentMethod.textContent = method;
        }

        // –ú–µ—Ç–æ–¥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ CORS proxy
        function loadWithProxy() {
            showLoading();
            updateStatus('–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ CORS proxy...', 'Proxy –º–µ—Ç–æ–¥');
            
            const proxy = proxies[0]; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–≤—ã–π –ø—Ä–æ–∫—Å–∏
            frame.src = proxy + targetUrl;
        }

        // –ú–µ—Ç–æ–¥ 2: –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ (–∏—Å–ø–æ–ª—å–∑—É—è fetch + blob)
        async function loadWithHeaders() {
            showLoading();
            updateStatus('–ó–∞–≥—Ä—É–∑–∫–∞ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏...', 'Fetch + Blob –º–µ—Ç–æ–¥');
            
            try {
                const response = await fetch(targetUrl, {
                    headers: {
                        'Origin': window.location.origin,
                        'X-Requested-With': 'XMLHttpRequest',
                        'User-Agent': navigator.userAgent
                    },
                    mode: 'cors'
                });
                
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                frame.src = url;
                
            } catch (err) {
                showError(`–û—à–∏–±–∫–∞ fetch: ${err.message}`);
            }
        }

        // –ú–µ—Ç–æ–¥ 3: –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
        function loadDirect() {
            showLoading();
            updateStatus('–ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞...', '–ü—Ä—è–º–æ–π –º–µ—Ç–æ–¥');
            frame.src = targetUrl;
        }

        // –ú–µ—Ç–æ–¥ 4: –û—Ç–∫—Ä—ã—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
        function openDirect() {
            window.open(targetUrl, '_blank');
        }

        function refresh() {
            if (frame.src) {
                showLoading();
                updateStatus('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...', '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ');
                frame.src = frame.src;
            }
        }

        function retry() {
            if (currentMethod.textContent.includes('Proxy')) {
                loadWithProxy();
            } else if (currentMethod.textContent.includes('Fetch')) {
                loadWithHeaders();
            } else {
                loadDirect();
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
        window.addEventListener('load', function() {
            // –ù–∞—á–∏–Ω–∞–µ–º —Å proxy –º–µ—Ç–æ–¥–∞
            setTimeout(loadWithProxy, 1000);
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è iframe
        frame.addEventListener('load', hideLoading);
        frame.addEventListener('error', function() {
            showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥.');
        });
    </script>
</body>
</html>
